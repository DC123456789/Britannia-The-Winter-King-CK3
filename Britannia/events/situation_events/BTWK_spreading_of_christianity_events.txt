namespace = spreading_of_christianity

###########################################
# The Spreading of Christianity Intro Event
# 0001
###########################################
spreading_of_christianity.0001 = { # Fullscreen Intro Event
	type = character_event
	window = fullscreen_event
	title = spreading_of_christianity.0001.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { religion = religion:christianity_religion }
				desc = spreading_of_christianity.0001.desc.christian
			}
			triggered_desc = {		# Hellenism has already been mostly marginalized by Christianity
				trigger = { religion = religion:hellenism_religion }
				desc = spreading_of_christianity.0001.desc.hellenic
			}
			triggered_desc = {
				trigger = {
					OR = {			# Brythonic and Gaelic paganism are also significantly under pressure
						faith = faith:briton_pagan
						faith = faith:gael_pagan
					}
				}
				desc = spreading_of_christianity.0001.desc.briton_gaelic
			}						# Other faiths are not yet as exposed
			desc = spreading_of_christianity.0001.desc.other_non_christian
		}
	}
	theme = realm
	override_background = { 
		reference = holy_site_christian
	}
	override_sound = { reference = "event:/DLC/FP2/SFX/UI/fp2_struggle_ui_intro_animate" }

	widgets = {
		widget = {
 			gui = "event_window_widget_situation_info_spreading_of_christianity"
 			container = "dynamic_content_widget"
 			controller = situation_info
 			setup_scope = { situation:spreading_of_christianity_situation = { save_scope_as = situation } }
		}
	}
	
	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = { religion = religion:christianity_religion }
						desc = spreading_of_christianity.0001.a.christian
					}
					triggered_desc = {
						trigger = { religion = religion:hellenism_religion }
						desc = spreading_of_christianity.0001.a.hellenic
					}
					triggered_desc = {
						trigger = {
							OR = {
								faith = faith:briton_pagan
								faith = faith:gael_pagan
							}
						}
						desc = spreading_of_christianity.0001.a.briton_gaelic
					}
					desc = spreading_of_christianity.0001.a.other_non_christian
				}
			}
		}
		clicksound = "event:/DLC/FP2/SFX/UI/fp2_struggle_start_select"
	}
}


# Toast for flipped provinces
spreading_of_christianity.0010 = {
	scope = none
	hidden = yes

	immediate = {
		scope:current_county.holder = {
			add_to_list = informees
			every_liege_or_above = {
				add_to_list = informees
			}
		}
		every_in_list = {
			list = informees
			switch = {
				trigger = faith
				scope:current_county.faith = { # Good if same as new faith
					send_interface_message = {
						type = msg_council_conversion_good
						title = spreading_of_christianity.0010.t
						desc = spreading_of_christianity.0010.desc
						right_icon = scope:current_county
					}
				}
				scope:old_faith = {
					send_interface_message = { # Bad if same faith as county
						type = msg_council_conversion_bad
						title = spreading_of_christianity.0010.t
						desc = spreading_of_christianity.0010.desc
						right_icon = scope:current_county
					}
				}
				fallback = {
					send_interface_message = { # Neutral otherwise
						type = msg_council_conversion_neutral
						title = spreading_of_christianity.0010.t
						desc = spreading_of_christianity.0010.desc
						right_icon = scope:current_county
					}
				}
			}
		}
	}
}

spreading_of_christianity.0020 = { # Subregion phase changes
	type = character_event
	title = spreading_of_christianity.0020.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_0 }
				}
				desc = spreading_of_christianity.0020.desc.phase_0.decreased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_0 }
				}
				desc = spreading_of_christianity.0020.desc.phase_0.decreased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_1 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_1.increased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_1 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_1.increased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_1 }
					global_var:soc_current_phase_change = flag:decreased
				}
				desc = spreading_of_christianity.0020.desc.phase_1.decreased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_1 }
					global_var:soc_current_phase_change = flag:decreased
				}
				desc = spreading_of_christianity.0020.desc.phase_1.decreased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_2 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_2.increased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_2 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_2.increased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_2 }
					global_var:soc_current_phase_change = flag:decreased
				}
				desc = spreading_of_christianity.0020.desc.phase_2.decreased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_2 }
					global_var:soc_current_phase_change = flag:decreased
				}
				desc = spreading_of_christianity.0020.desc.phase_2.decreased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_3 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_3.increased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_3 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_3.increased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_3 }
					global_var:soc_current_phase_change = flag:decreased
				}
				desc = spreading_of_christianity.0020.desc.phase_3.decreased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_3 }
					global_var:soc_current_phase_change = flag:decreased
				}
				desc = spreading_of_christianity.0020.desc.phase_3.decreased.non_christian
			}
			triggered_desc = {
				trigger = { 
					religion = religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_4 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_4.increased.christian
			}
			triggered_desc = {
				trigger = { 
					religion != religion:christianity_religion
					scope:current_sub_region = { sub_region_current_phase = spreading_of_christianity_phase_4 }
					global_var:soc_current_phase_change = flag:increased
				}
				desc = spreading_of_christianity.0020.desc.phase_4.increased.non_christian
			}
		}
	}
	
	theme = realm
	override_background = { 		# TODO
		reference = holy_site_christian
	}
	
	immediate = {
		situation:spreading_of_christianity_situation = { save_scope_as = situation }
		if = {
			limit = { global_var:soc_current_phase_change = flag:increased }
			custom_tooltip = spreading_of_christianity.0020.tt_phase_increased
		}
		else_if = {
			limit = { global_var:soc_current_phase_change = flag:decreased }
			custom_tooltip = spreading_of_christianity.0020.tt_phase_decreased
		}
	}
	
	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = { 
							religion = religion:christianity_religion
							global_var:soc_current_phase_change = flag:increased
						}
						desc = spreading_of_christianity.0020.a.increased.christian
					}
					triggered_desc = {
						trigger = { 
							religion != religion:christianity_religion
							global_var:soc_current_phase_change = flag:increased
						}
						desc = spreading_of_christianity.0020.a.increased.non_christian
					}
					triggered_desc = {
						trigger = { 
							religion = religion:christianity_religion
							global_var:soc_current_phase_change = flag:decreased
						}
						desc = spreading_of_christianity.0020.a.decreased.christian
					}
					triggered_desc = {
						trigger = { 
							religion != religion:christianity_religion
							global_var:soc_current_phase_change = flag:decreased
						}
						desc = spreading_of_christianity.0020.a.decreased.non_christian
					}
				}
			}
		}
	}
}