# All decisions need to be made permanently unavailable once triggered.
# Add stewardship or martial checks?

begin_construction_offas_dyke_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_realm.dds"
	}
	decision_group_type = major

	ai_check_interval_by_tier = {
		barony = 0
		county = 0
		duchy = 0
		kingdom = 36
		empire = 36
		hegemony = 36
	}

	desc = begin_construction_offas_dyke_decision_desc
	selection_tooltip = begin_construction_offas_dyke_decision_tooltip
	confirm_text = begin_construction_offas_dyke_decision_confirm

	is_shown = {
		is_ingvaeonic_culture_trigger = yes
		primary_title = {
			tier >= tier_duchy
		}
		any_sub_realm_county = {
			title_province = {
				geographical_region = btwk_custom_britannia_midwest
			}
		}
		NOT = { has_global_variable = offas_dyke_decision }
#		has_global_variable = fall_of_britannia
	}

	is_valid =  {
		is_independent_ruler = yes
		completely_controls_region = btwk_custom_england_wales_border
		prestige_level >= 3
		primary_title = {
			tier >= tier_kingdom
		}
		custom_description = {
			text = construct_offas_dyke_counties_trigger	
			any_county_in_region = {
				count >= 30
				region = btwk_custom_britannia_midwest
				this.holder.top_liege = root
			}
		}
	}
	
	effect = {
		trigger_event = BTWK_frontier_event.0001
		set_global_variable = offas_dyke_decision
	}
}

begin_restoration_antonine_wall_decision = {
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_realm.dds"
	}
	decision_group_type = major

	ai_check_interval_by_tier = {
		barony = 0
		county = 0
		duchy = 0
		kingdom = 36
		empire = 36
		hegemony = 36
	}

	desc = begin_restoration_antonine_wall_decision_desc
	selection_tooltip = begin_restoration_antonine_wall_decision_tooltip
	confirm_text = begin_restoration_antonine_wall_decision_confirm

	is_shown = {
		always = no  # REMOVE WHEN CALEDONIA ADDED!
		is_imperial_culture_trigger = yes
		is_independent_ruler = yes
		primary_title = {
			tier > tier_duchy
		}
		any_sub_realm_county = {
			title_province = {
				geographical_region = btwk_custom_northern_hen_ogledd
			}				
		}
	}
	
	is_valid =  {
		primary_title = {
			tier >= tier_kingdom
		}
		custom_description = {
			text = "Holds all counties between Hadrian's Wall and the old Antonine Wall."
			completely_controls_region = btwk_custom_northern_hen_ogledd_roman
		}
		prestige_level >= 3
		sub_realm_size >= 50  # PLACEHOLDER	
		NOT = {
			custom_description = {
				text = "Does not hold any counties beyond the old Antonine Wall."			
				any_county_in_region = {
					region = custom_caledonia_lower
					this.holder = root
				}
			}

		}	
	}

	effect = {
		trigger_event = BTWK_frontier_event.0101
	}
}

restore_hadrians_wall_decision = {
	
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_realm.dds"
	}
	decision_group_type = major

	ai_check_interval_by_tier = {
		barony = 0
		county = 0
		duchy = 0
		kingdom = 36
		empire = 36
		hegemony = 36
	}

	desc = restore_hadrians_wall_decision_desc
	selection_tooltip = restore_hadrians_wall_decision_tooltip
	confirm_text = restore_hadrians_wall_decision_confirm

	is_shown = {
		any_sub_realm_county = {
			title_province = {
				geographical_region = btwk_world_britannia_hen_ogledd
			}
		}
		NOR = { 
			has_global_variable = restore_hadrians_wall_decision
			AND = {		# Romanized characters can still rebuild a torn down wall if they want
				has_global_variable = ruin_hadrians_wall_decision
				is_imperial_like_culture_trigger = no
			}
		}
	}
	
	is_valid = {
		is_independent_ruler = yes
		primary_title = {
			tier >= tier_kingdom
		}
		culture = { 
			has_innovation = innovation_crop_rotation
		}
		completely_controls_region = btwk_custom_hadrians_wall_duchies
		OR = {
			is_imperial_like_culture_trigger = yes
			has_trait = romanitas_trait
		}
		NOT = { has_trait = barbarian_trait }
	}

	effect = {
		custom_tooltip = BTWK_frontier_event.0210.a_tt
		if = {
			limit = { has_global_variable = ruin_hadrians_wall_decision }
			custom_tooltip = BTWK_frontier_event.0210.a_tt_1
		}
			
		show_as_tooltip = {
			add_prestige = 200	
			if = {
				limit = {
					is_imperial_like_culture_trigger = yes
				}
				add_legitimacy = medium_legitimacy_gain
			}
		}
		
		save_scope_as = rebuilder
		trigger_event = BTWK_frontier_event.0210
		every_player = {
			limit = { this != root }
			trigger_event = BTWK_frontier_event.0210
		}
		set_global_variable = restore_hadrians_wall_decision
		remove_global_variable = ruin_hadrians_wall_decision
	}
	
	cost = {
		gold = 200
	}

	ai_will_do = {
		base = 50
		modifier = {
			factor = 0
			NOR = {
				is_imperial_like_culture_trigger = yes
				has_trait = romanitas_trait
			}
		}
	}
}

ruin_hadrians_wall_decision = {
	
	picture = {
		reference = "gfx/interface/illustrations/decisions/decision_realm.dds"
	}
	decision_group_type = major

	ai_check_interval_by_tier = {
		barony = 0
		county = 0
		duchy = 0
		kingdom = 36
		empire = 36
		hegemony = 36
	}

	desc = ruin_hadrians_wall_decision_desc
	selection_tooltip = ruin_hadrians_wall_decision_tooltip
	confirm_text = ruin_hadrians_wall_decision_confirm


	is_shown = {
		any_sub_realm_county = {
			title_province = {
				geographical_region = btwk_world_britannia_hen_ogledd
			}
		}
		NOR = { 
			has_global_variable = ruin_hadrians_wall_decision
			AND = {		# Non-Romans can still tear down a restored wall if they want
				has_global_variable = restore_hadrians_wall_decision
				is_imperial_like_culture_trigger = yes
			}
		}
	}
	
	is_valid = {
		is_independent_ruler = yes
		primary_title = {
			tier >= tier_kingdom
		}
		completely_controls_region = btwk_custom_hadrians_wall_duchies
		prestige_level >= 3
		custom_description = {
			text = ruin_hadrians_wall_counties_trigger
			any_county_in_region = {
				count >= 50
				region = btwk_world_britannia_hen_ogledd
				this.holder.top_liege = root
			}
		}
	}

	effect = {
		custom_tooltip = BTWK_frontier_event.0201.a_tt
		custom_tooltip = BTWK_frontier_event.0201.a_tt_1
		show_as_tooltip = {
			add_character_modifier = {
				modifier = destroyed_hadrians_wall_character_modifier
			}
			if = {
				limit = {
					is_imperial_like_culture_trigger = yes
				}
				add_legitimacy = medium_legitimacy_loss
			}
		}
		
		trigger_event = BTWK_frontier_event.0201
		set_global_variable = ruin_hadrians_wall_decision
		remove_global_variable = restore_hadrians_wall_decision
	}

	ai_will_do = {
		base = 25
		modifier = {
			factor = 0
			OR = {
				is_imperial_like_culture_trigger = yes
				has_trait = romanitas_trait
			}
		}
	}
}
