is_child_culture_of_trigger = {
	$TARGET$ = { save_temporary_scope_as = target_culture }
	any_parent_culture = { this = scope:target_culture }
}

# Does the culture derive primarily from Romano-British?
is_romanobritish_culture_trigger = {
	culture = { culture_is_romanobritish_culture_trigger = yes }
}

# TODO Make this a (hidden?) parameter of Romano-British and derived cultures instead
culture_is_romanobritish_culture_trigger = {
	has_cultural_pillar = heritage_latin
	OR = {
		THIS = culture:romanobritish
		any_parent_culture = {
            custom_tooltip = {
                text = is_romanobritish_trigger_desc
				culture_is_romanobritish_culture_trigger = yes
			}
		}
	}
}

# Determines access to Brythonic titles and mechanics
# Does the culture derive primarily from Briton, Cumbrian, or Romano-British?
is_brythonic_culture_trigger = {
    custom_tooltip = {
		text = is_brythonic_culture_trigger_desc
        culture = { culture_is_brythonic_culture_trigger = yes }
	}
}

culture_is_brythonic_culture_trigger = {
	OR = {
		has_cultural_pillar = heritage_brythonic
        AND = {
            has_cultural_pillar = heritage_latin
			this.var:ancestral_starting_culture = culture:romanobritish
        }
        AND = {
            has_cultural_pillar = heritage_romance
			this.var:ancestral_starting_culture = culture:romanobritish
			NOT = { has_variable = ancestral_non_roman_culture }
        }
	}
}

is_celtic_culture_trigger = {
    custom_tooltip = {
		text = is_celtic_culture_trigger_desc
        culture = { has_same_heritage_family_as = { TARGET = culture:briton } }
	}
}

can_create_roman_celtic_titles_trigger = {
	culture = {
		NOR = {
			has_cultural_pillar = heritage_west_germanic
			has_cultural_pillar = heritage_frankish
			has_cultural_pillar = heritage_central_germanic
			has_cultural_pillar = heritage_north_germanic
		}
	}
}

# Determines access to Romanized Germanic titles (= Roman titles, pretty much)
is_romanized_barbarian_culture_trigger = {
	culture = { culture_is_romanized_barbarian_culture_trigger = yes }
}

culture_is_romanized_barbarian_culture_trigger = {
	OR = {
		has_cultural_pillar = heritage_romanized_germanic
		has_cultural_pillar = heritage_romanized_sarmatian
	}
}

# Determines access to Anglo-Saxon titles and mechanics
# Does the culture derive primarily from Angle, Old Saxon, Jute, or Old Frisian?
is_ingvaeonic_culture_trigger = {
	culture = { has_cultural_pillar = heritage_west_germanic }
}

culture_is_ingvaeonic_culture_trigger = {
	has_cultural_pillar = heritage_west_germanic
}

is_unromanized_germanic_culture_trigger = {
	culture = {
		OR = {
			has_cultural_pillar = heritage_west_germanic
			has_cultural_pillar = heritage_frankish
			has_cultural_pillar = heritage_central_germanic
			has_cultural_pillar = heritage_north_germanic
		}
	}
}

is_germanic_culture_trigger = {
	culture = { has_same_heritage_group_as = { TARGET = culture:angle } }
}

is_old_saxon_culture_trigger = { 
# Used in Anglo-Saxon patron deity selection: Wodan (Angle, Frisian, Jutish) vs. Seaxneat (Saxon)
	OR = {
		is_culture_or_descendant_trigger = { CULTURE = culture:old_saxon }
		is_culture_or_descendant_trigger = { CULTURE = culture:saxon }
	}
}

is_imperial_culture_trigger = {
	culture = { has_cultural_pillar = heritage_latin }
}

is_imperial_like_culture_trigger = { 
	custom_tooltip = {
		text = is_imperial_like_culture_trigger_desc
		OR = {
			is_brythonic_culture_trigger = yes
			is_imperial_culture_trigger = yes
			is_romanized_barbarian_culture_trigger = yes
			culture = { has_cultural_pillar = heritage_romance }
		}
	}
}

is_romanized_government_culture_trigger = {
	culture = {
		OR = {
			has_cultural_pillar = heritage_latin
			has_cultural_pillar = heritage_romanized_germanic
			has_cultural_pillar = heritage_romanized_sarmatian
			has_cultural_pillar = heritage_frankish
			has_cultural_pillar = heritage_romance
			AND = {
				has_cultural_pillar = heritage_brythonic
				NOT = { has_global_variable = end_of_britannia }
			}
		}
	}
}

# Either is the given culture, or is a descendant of it through a chain of parent/child cultures
# that all share the same heritage
culture_is_culture_or_descendant_trigger = {
	custom_description = {
		text = culture_is_culture_or_descendant_trigger
		$CULTURE$ = { save_temporary_scope_as = trigger_current_culture }
		OR = {
			this = $CULTURE$
			any_parent_culture = {
				has_same_culture_heritage = prev
				culture_is_culture_or_descendant_helper_trigger = yes
			}
		}
	}
}

# Avoids recursive triggers with parameters, which hang the game
culture_is_culture_or_descendant_helper_trigger = {
	OR = {
		this = scope:trigger_current_culture
		any_parent_culture = {
			has_same_culture_heritage = prev
			culture_is_culture_or_descendant_helper_trigger = yes
		}
	}
}

is_culture_or_descendant_trigger = {
	$CULTURE$ = { 
		save_temporary_scope_as = trigger_current_culture 
		custom_description = {
			text = is_culture_or_descendant_trigger
			subject = this
			object = prev
			prev.culture = { culture_is_culture_or_descendant_trigger = { CULTURE = scope:trigger_current_culture } }
		}
	}
}

# Avoids recursive triggers with parameters, which hang the game
culture_is_culture_or_descendant_including_romance_helper_trigger = {
	OR = {
		this = scope:trigger_current_culture
		any_parent_culture = {
			has_same_culture_heritage = prev
			culture_is_culture_or_descendant_helper_trigger = yes
		}
		AND = {
			has_cultural_pillar = heritage_romance
			any_parent_culture = {
				culture_is_culture_or_descendant_including_romance_helper_trigger = yes
			}
		}
	}
}

culture_is_culture_or_descendant_including_romance_trigger = {
	$CULTURE$ = { 
		save_temporary_scope_as = trigger_current_culture 
		prev = { 
			culture_is_culture_or_descendant_including_romance_helper_trigger = yes
		}
	}
}

# Either is the given culture, or is a descendant of it through a chain of parent/child cultures
# that all share the same heritage
# This trigger also allows returns true for any Romance culture that is descended from same-heritage 
# descendants of the given culture, or Romance descendants of such a culture
# Use when you want a custom description
is_culture_or_descendant_including_romance_trigger = {
	$CULTURE$ = { 
		save_temporary_scope_as = trigger_current_culture 
		custom_description = {
			text = is_culture_or_descendant_including_romance_trigger
			subject = this
			object = prev
			prev.culture = { 
				culture_is_culture_or_descendant_including_romance_helper_trigger = yes
			}
		}
	}
}

# Use when you want a custom tooltip
is_culture_or_descendant_including_romance_w_tooltip_trigger = {
	$CULTURE$ = { save_temporary_scope_as = trigger_current_culture	}	
	custom_tooltip = {
		text = is_culture_or_descendant_including_romance_tt
		is_culture_or_descendant_including_romance_trigger = { CULTURE = scope:trigger_current_culture }
	}
}

# Determines if whether or not the domicile holder participates in a culture shift is primarily
# determined by the domicile holder, and if they should be treated as a domicile holder rather
# than an ordinary landed ruler
is_independent_domicile_holder_for_culture_shift_trigger = {					
	is_landed = no
	# Doesn't have a close family member whose culture will take precedence
	NOT = {
		any_close_family_member = {
			is_landed = yes
			culture = prev.culture
		}
	}
}

bg_game_type_region_tabula_trigger = { #For Roman and Romanized cultures and as fallback for pre-chess cultures
	OR = {
		has_cultural_pillar = heritage_latin
		has_cultural_pillar = heritage_basque
		has_cultural_pillar = heritage_israelite
		has_cultural_pillar = heritage_romanized_germanic
		has_cultural_pillar = heritage_romanized_sarmatian
		has_cultural_pillar = heritage_berber
		has_cultural_pillar = heritage_turkic
	}
}

bg_game_type_region_hnefatafl_trigger = { #For Germanic cultures
	OR = {
		has_cultural_pillar = heritage_west_germanic
		has_cultural_pillar = heritage_frankish
		has_cultural_pillar = heritage_central_germanic
		has_cultural_pillar = heritage_north_germanic
	}
}

bg_game_type_region_fidchell_trigger = { #For Celtic cultures
	OR = {
		has_cultural_pillar = heritage_brythonic
		has_cultural_pillar = heritage_goidelic
		has_cultural_pillar = heritage_pictish
	}
}

#Chess automatically functions as a fallback and will be used for Romance and Arabic cultures

bg_game_type_region_pachisi_trigger = { #Off-map
	always = no
}

bg_game_type_region_go_trigger = { #Off-map
	always = no
}

culture_has_coronations_trigger = {
	trigger_if = {
		limit = { NOT = { culture = { has_innovation = innovation_coronations } } }
		culture = { has_innovation = innovation_coronations }
	}
	trigger_else_if = {
		limit = { 
			culture = { 
				has_innovation = innovation_coronations
				NOT = { has_variable = coronations_enabled }
			}
		}
		custom_tooltip = {
			text = wait_for_coronations_to_be_enabled
			culture = { 
				has_innovation = innovation_coronations
				has_variable = coronations_enabled
			}
		}
	}
	trigger_else = {
		culture = { has_innovation = innovation_coronations }
	}
}